#!/bin/bash
# å°èˆªç³»çµ±å¿«é€Ÿå•Ÿå‹•æŒ‡å—
# Robot Monitor Navigation System Quick Start

cat << 'EOF'

================================================================================
                    ã€æ©Ÿå™¨äººå°èˆªç³»çµ± - å¿«é€Ÿå•Ÿå‹•ã€‘
================================================================================

ã€æ­¥é©Ÿ 1ã€‘å•Ÿå‹• ROS 2 ç³»çµ± (åœ¨ WSL çµ‚ç«¯)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

$ cd /home/ray/ros2_ws
$ source install/setup.bash
$ export ROS_DOMAIN_ID=30
$ python3 start_all.py

é æœŸè¼¸å‡º:
  âœ“ rosbridge_websocket running (port 9090)
  âœ“ throttle node running (0.8 Hz)
  âœ“ SLAM running
  âœ“ trust_map_solver running
  âœ“ HTTP server running (port 8000)

ã€æ­¥é©Ÿ 2ã€‘é–‹å•Ÿç¶²é  (åœ¨ä»»ä½•ç€è¦½å™¨)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

http://localhost:8000

âœ“ æ‡‰çœ‹åˆ°å¯¦æ™‚ SLAM åœ°åœ–å’Œæ©Ÿå™¨äººç®­é ­

ã€æ­¥é©Ÿ 3ã€‘æ¸¬è©¦å°èˆªåŠŸèƒ½
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. å³éµé»æ“Šåœ°åœ–ä¸Šçš„ä»»æ„ä½ç½®
   â†’ ã€Œå‰å¾€ã€æ³¡æ³¡å‡ºç¾åœ¨æ»‘é¼ ä½ç½®

2. é»æ“Šæ³¡æ³¡
   â†’ å°èˆªæ¬„å¾åº•éƒ¨æ»‘å‡º
   â†’ æŒ‰éˆ•: â¸ æš«åœ (æ©™è‰²) | âœ• å–æ¶ˆ (ç´…è‰²)
   â†’ ç·¨ç¢¼å™¨é¢æ¿ (å³ä¸Š) é¡¯ç¤º X/Y/Î¸ æ•¸æ“š

3. é»æ“Šã€æš«åœã€‘
   â†’ æŒ‰éˆ•è®Šç¶ è‰²ï¼Œæ–‡å­—è®Šã€Œâ–¶ ç¹¼çºŒã€
   â†’ ç™¼é€ PAUSE å‘½ä»¤åˆ°é¦¬é”

4. é»æ“Šã€ç¹¼çºŒã€‘
   â†’ æŒ‰éˆ•è®Šæ©™è‰²ï¼Œæ–‡å­—è®Šã€Œâ¸ æš«åœã€
   â†’ ç™¼é€ RESUME å‘½ä»¤åˆ°é¦¬é”

5. é»æ“Šã€å–æ¶ˆã€‘
   â†’ å°èˆªæ¬„éš±è—
   â†’ ç™¼é€ CANCEL å‘½ä»¤åˆ°é¦¬é”

ã€æ­¥é©Ÿ 4ã€‘é©—è­‰è·¯å¾‘è¨˜æ†¶ï¼ˆå¯é¸ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

åœ¨å¦ä¸€å€‹çµ‚ç«¯åŸ·è¡Œç›£æ§å‘½ä»¤:
$ ros2 topic echo /viz_map_data

è§€å¯Ÿè¼¸å‡ºä¸­çš„ "walls: X" æ•¸å­—ï¼Œæ‡‰è©²é€æ¼¸å¢åŠ 
è¡¨ç¤ºæ­·å²ç‰†é«”è¢«æ°¸ä¹…ä¿å­˜

================================================================================

ã€ç³»çµ±çµ„ä»¶æ¸…å–®ã€‘

âœ… å·²å®Œæˆ (WSL ç«¯):
  â”œâ”€ Web UI (index.html)
  â”‚  â”œâ”€ åœ°åœ–ç•«å¸ƒ (Canvas)
  â”‚  â”œâ”€ ç·¨ç¢¼å™¨é¢æ¿ (å³ä¸Š)
  â”‚  â”œâ”€ å°èˆªæ§åˆ¶æ¬„ (åº•éƒ¨)
  â”‚  â””â”€ æš«åœ/ç¹¼çºŒ/å–æ¶ˆæŒ‰éˆ•
  â”‚
  â”œâ”€ JavaScript é‚è¼¯ (map_viewer.js)
  â”‚  â”œâ”€ ROS è©±é¡Œç™¼ä½ˆ (/nav_goal, /motor_control)
  â”‚  â”œâ”€ ROS è©±é¡Œè¨‚é–± (/encoder_state, /robot_status)
  â”‚  â”œâ”€ å°èˆªç‹€æ…‹ç®¡ç† (navigationActive, motorPaused)
  â”‚  â””â”€ æŒ‰éˆ•äº‹ä»¶è™•ç†
  â”‚
  â”œâ”€ è·¯å¾‘è¨˜æ†¶ (trust_map_solver.py)
  â”‚  â”œâ”€ historical_walls æ•¸æ“šçµæ§‹
  â”‚  â”œâ”€ æƒæåˆ°çš„ç‰†é«”æ°¸ä¹…ä¿å­˜
  â”‚  â””â”€ ç™¼ä½ˆåŒ…å«æ­·å²æ•¸æ“šçš„åœ°åœ–
  â”‚
  â”œâ”€ ç³»çµ±å•Ÿå‹• (start_all.py)
  â”‚  â”œâ”€ ROS_DOMAIN_ID=30 è¨­å®š
  â”‚  â”œâ”€ æ‰€æœ‰æœå‹™è‡ªå‹•å•Ÿå‹•
  â”‚  â””â”€ æ­£ç¢ºçš„ç’°å¢ƒè®Šæ•¸å‚³é
  â”‚
  â””â”€ æ¸¬è©¦å·¥å…· (test_navigation.py)
     â”œâ”€ ç›£è½ /nav_goal
     â”œâ”€ ç›£è½ /motor_control
     â”œâ”€ ç™¼ä½ˆ /encoder_state (æ¨¡æ“¬)
     â””â”€ ç™¼ä½ˆ /robot_status (æ¨¡æ“¬)

â³ å¾…å¯¦ç¾ (PI ç«¯ - ä¸åœ¨ WSL):
  â”œâ”€ é¦¬é”é©…å‹• (GPIO æ§åˆ¶)
  â”œâ”€ ç·¨ç¢¼å™¨è®€å– (å…‰å­¸è„ˆè¡)
  â”œâ”€ å¯¼èˆªç®—æ³•å¯¦ç¾
  â””â”€ åƒè€ƒç¯„æœ¬: pi_motor_controller_template.py

================================================================================

ã€æª”æ¡ˆæ˜ å°„ã€‘

index.html
  â””â”€ åŒ…å«: nav-bar, encoder-panel, æš«åœ/å–æ¶ˆæŒ‰éˆ•

style.css
  â”œâ”€ #nav-bar - åº•éƒ¨æ§åˆ¶æ¬„
  â”œâ”€ #encoder-panel - å³ä¸Šç·¨ç¢¼å™¨é¡¯ç¤º
  â”œâ”€ .pause-btn - æš«åœæŒ‰éˆ• (å‹•æ…‹é¡: .resumed)
  â””â”€ å‹•ç•«: slideUp (0.3s)

map_viewer.js
  â”œâ”€ navigationActive - å°èˆªé€²è¡Œä¸­æ¨™èªŒ
  â”œâ”€ motorPaused - é¦¬é”æš«åœæ¨™èªŒ
  â”œâ”€ encoderData - ç·¨ç¢¼å™¨æ•¸æ“š
  â”œâ”€ navGoalPublisher - ç™¼ä½ˆå°èˆªç›®æ¨™
  â”œâ”€ motorControlPublisher - ç™¼ä½ˆé¦¬é”å‘½ä»¤
  â”œâ”€ showNavigationBar() - é¡¯ç¤ºåº•éƒ¨æ¬„
  â”œâ”€ updatePauseButtonState() - æ›´æ–°æŒ‰éˆ•å¤–è§€
  â”œâ”€ æ³¡æ³¡é»æ“Š: ç™¼é€ /nav_goal
  â”œâ”€ æš«åœæŒ‰éˆ•: ç™¼é€ PAUSE/RESUME åˆ° /motor_control
  â””â”€ å–æ¶ˆæŒ‰éˆ•: ç™¼é€ CANCEL åˆ° /motor_control

trust_map_solver.py
  â”œâ”€ historical_walls{} - æ°¸ä¹…ç‰†é«”è¨˜éŒ„
  â”œâ”€ current_scan_cells{} - ç•¶å‰æƒæç¯„åœ
  â”œâ”€ update_map() - æ¨™è¨˜å‘½ä¸­é»åˆ°æ­·å²è¨˜éŒ„
  â””â”€ publish_map() - å„ªå…ˆç™¼ä½ˆæ­·å²æ•¸æ“š

start_all.py
  â”œâ”€ ROS_DOMAIN_ID=30 è¨­å®š
  â”œâ”€ rosbridge_websocket å•Ÿå‹•
  â”œâ”€ throttle ç¨ç«‹å•Ÿå‹•
  â”œâ”€ pc_monitor_launch (SLAM)
  â”œâ”€ trust_map_solver
  â””â”€ HTTP server (port 8000)

================================================================================

ã€æ•…éšœæ’é™¤ã€‘

Q: å°èˆªæ¬„ä¸é¡¯ç¤ºï¼Ÿ
A: 1. æª¢æŸ¥ console æ˜¯å¦æœ‰ JS éŒ¯èª¤ (F12)
   2. ç¢ºèª index.html æœ‰ id="nav-bar" å…ƒç´ 
   3. ç¢ºèª map_viewer.js å·²åŠ è¼‰

Q: ç·¨ç¢¼å™¨æ•¸æ“šä¸æ›´æ–°ï¼Ÿ
A: 1. PI æ˜¯å¦ç™¼ä½ˆäº† /encoder_state?
   2. ROS_DOMAIN_ID æ˜¯å¦éƒ½è¨­ç‚º 30?
   3. çµ‚ç«¯ç¢ºèª: ros2 topic echo /encoder_state

Q: è·¯å¾‘ä¸ä¿å­˜ï¼Ÿ
A: 1. æª¢æŸ¥ trust_map_solver.py æ˜¯å¦æœ‰ historical_walls
   2. é‡å•Ÿ start_all.py
   3. æŸ¥çœ‹æ—¥èªŒä¸­çš„ "walls: X" æ•¸å­—æ˜¯å¦å¢åŠ 

Q: é¦¬é”æ§åˆ¶æ²’åæ‡‰ï¼Ÿ
A: 1. PI ç«¯æ˜¯å¦è¨‚é–±äº† /motor_control?
   2. æª¢æŸ¥æ—¥èªŒ: ros2 topic echo /motor_control
   3. ROS_DOMAIN_ID ä¸€è‡´æ€§æª¢æŸ¥

================================================================================

ã€é–‹ç™¼è€…æ–‡æª”ã€‘

è©³è¦‹: NAVIGATION_GUIDE.py (å®Œæ•´ç³»çµ±æ–‡æª”)
åƒè€ƒ: pi_motor_controller_template.py (PI ç«¯å¯¦ç¾ç¯„æœ¬)

================================================================================

ã€é—œéµ ROS 2 è©±é¡Œã€‘

/nav_goal (geometry_msgs/PoseStamped)
  ç™¼ä½ˆè€…: ç¶²é  (map_viewer.js)
  è¨‚é–±è€…: PI é¦¬é”æ§åˆ¶å™¨
  è³‡æ–™: {position: {x, y, z}, orientation: {x, y, z, w}}

/motor_control (std_msgs/String)
  ç™¼ä½ˆè€…: ç¶²é  (map_viewer.js)
  è¨‚é–±è€…: PI é¦¬é”æ§åˆ¶å™¨
  å€¼: "PAUSE" | "RESUME" | "CANCEL"

/encoder_state (geometry_msgs/Twist)
  ç™¼ä½ˆè€…: PI ç·¨ç¢¼å™¨è®€å–å™¨
  è¨‚é–±è€…: ç¶²é  (map_viewer.js)
  è³‡æ–™: {linear: {x, y, z}, angular: {z}}

/robot_status (std_msgs/String)
  ç™¼ä½ˆè€…: PI ç‹€æ…‹ç›£æ§
  è¨‚é–±è€…: ç¶²é  (map_viewer.js)
  å€¼: ä»»æ„ç‹€æ…‹å­—ç¬¦ä¸²

================================================================================

ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸ¤–

EOF
