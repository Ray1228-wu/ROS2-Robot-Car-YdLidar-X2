#!/bin/bash
# å°èˆªç³»çµ±å¿«é€Ÿå•Ÿå‹•æŒ‡å—
# Robot Monitor Navigation System Quick Start

cat << 'EOF'

================================================================================
                    ã€æ©Ÿå™¨äººå°èˆªç³»çµ± - å¿«é€Ÿå•Ÿå‹•ã€‘
================================================================================

ã€æ­¥é©Ÿ 1ã€‘å•Ÿå‹• ROS 2 ç³»çµ± (åœ¨ WSL çµ‚ç«¯)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

$ cd ros2_PC/              # é€²å…¥å·¥ä½œå€ç›®éŒ„
$ python3 start_all.py     # è‡ªå‹•ä½¿ç”¨ç›¸å°è·¯å¾‘å•Ÿå‹•

ğŸ’¡ ç›¸å°è·¯å¾‘å„ªé»: è¤‡è£½æ•´å€‹è³‡æ–™å¤¾åˆ°ä»»ä½•ä½ç½®éƒ½èƒ½ç›´æ¥åŸ·è¡Œï¼
   ç„¡éœ€ä¿®æ”¹çµ•å°è·¯å¾‘ /home/ray/ros2_PC

é æœŸè¼¸å‡º:
  âœ“ rosbridge_websocket running (port 9090)
  âœ“ throttle node running (0.8 Hz)
  âœ“ SLAM running
  âœ“ trust_map_solver running
  âœ“ HTTP server running (port 8000)

ã€æ­¥é©Ÿ 2ã€‘é–‹å•Ÿç¶²é  (åœ¨ä»»ä½•ç€è¦½å™¨)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

http://localhost:8000

âœ“ æ‡‰çœ‹åˆ°å¯¦æ™‚ SLAM åœ°åœ–å’Œæ©Ÿå™¨äººç®­é ­

ã€æ­¥é©Ÿ 3ã€‘æ¸¬è©¦å°èˆªåŠŸèƒ½ (å…©ç¨®æ¨¡å¼)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  æ¨¡å¼ A: è‡ªå‹•å°èˆª (å³éµé»æ“Š)            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. å³éµé»æ“Šåœ°åœ–ä¸Šçš„ä»»æ„ä½ç½®
   â†’ ã€Œå‰å¾€ã€æ³¡æ³¡å‡ºç¾åœ¨æ»‘é¼ ä½ç½®

2. é»æ“Šæ³¡æ³¡
   â†’ å°èˆªæ¬„å¾åº•éƒ¨æ»‘å‡º â¬‡ï¸
   â†’ æŒ‰éˆ•: â¸ æš«åœ (æ©™è‰²) | âœ• å–æ¶ˆ (ç´…è‰²)
   â†’ ç™¼é€ /nav_goal åˆ° PI

3. é»æ“Šã€æš«åœã€‘
   â†’ æŒ‰éˆ•è®Šç¶ è‰²ï¼Œæ–‡å­—è®Šã€Œâ–¶ ç¹¼çºŒã€
   â†’ ç™¼é€ PAUSE åˆ° /motor_control

4. é»æ“Šã€ç¹¼çºŒã€‘
   â†’ æŒ‰éˆ•è®Šæ©™è‰²ï¼Œæ–‡å­—è®Šã€Œâ¸ æš«åœã€
   â†’ ç™¼é€ RESUME åˆ° /motor_control

5. é»æ“Šã€å–æ¶ˆã€‘
   â†’ å°èˆªæ¬„éš±è—
   â†’ ç™¼é€ CANCEL åˆ° /motor_control

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  æ¨¡å¼ B: æ‰‹å‹•æ§åˆ¶ (éµç›¤ WASD)           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

åœ¨åœ°åœ–ä¸ŠæŒ‰ä¸‹ä»¥ä¸‹æŒ‰éµ (ç„¦é»éœ€è¦åœ¨é é¢å…§):

  W ..................... å‰é€² (FORWARD|0.3 m/s)
  S ..................... å¾Œé€€ (BACKWARD|0.3 m/s)
  A ..................... å·¦è½‰ (LEFT|0.3 rad/s)
  D ..................... å³è½‰ (RIGHT|0.3 rad/s)
  Space ................. æš«åœ (MANUAL_PAUSE)
  é¬†é–‹ WASD ............. åœæ­¢ (STOP)

ğŸ’¡ æ‰‹å‹•æ§åˆ¶ç™¼ä½ˆåˆ° /manual_control topic
   èˆ‡å°èˆªæ§åˆ¶ (/motor_control) ç¨ç«‹é‹è¡Œ

âš¡ æŒ‡ä»¤æ ¼å¼ (ç™¼é€åˆ° PI çš„é¦¬é”æ§åˆ¶ç¯€é»):
   FORWARD|0.3   - å‰é€²ï¼Œé€Ÿåº¦ 0.3 m/s
   LEFT|0.3      - å·¦è½‰ï¼Œè§’é€Ÿåº¦ 0.3 rad/s
   STOP          - ç«‹å³åœæ­¢

ã€æ­¥é©Ÿ 4ã€‘é©—è­‰è·¯å¾‘è¨˜æ†¶ï¼ˆå¯é¸ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

åœ¨å¦ä¸€å€‹çµ‚ç«¯åŸ·è¡Œç›£æ§å‘½ä»¤:
$ ros2 topic echo /viz_map_data

è§€å¯Ÿè¼¸å‡ºä¸­çš„ "walls: X" æ•¸å­—ï¼Œæ‡‰è©²é€æ¼¸å¢åŠ 
è¡¨ç¤ºæ­·å²ç‰†é«”è¢«æ°¸ä¹…ä¿å­˜

================================================================================

ã€ç³»çµ±çµ„ä»¶æ¸…å–®ã€‘

âœ… å·²å®Œæˆ (WSL ç«¯):
  â”œâ”€ Web UI (index.html)
  â”‚  â”œâ”€ åœ°åœ–ç•«å¸ƒ (Canvas)
  â”‚  â”œâ”€ ç·¨ç¢¼å™¨é¢æ¿ (å³ä¸Š)
  â”‚  â”œâ”€ å°èˆªæ§åˆ¶æ¬„ (åº•éƒ¨)
  â”‚  â””â”€ æš«åœ/ç¹¼çºŒ/å–æ¶ˆæŒ‰éˆ•
  â”‚
  â”œâ”€ JavaScript é‚è¼¯ (map_viewer.js)
  â”‚  â”œâ”€ ROS è©±é¡Œç™¼ä½ˆ
  â”‚  â”‚  â”œâ”€ /nav_goal (geometry_msgs/PoseStamped) - è‡ªå‹•å°èˆª
  â”‚  â”‚  â”œâ”€ /motor_control (std_msgs/String) - å°èˆªæ§åˆ¶
  â”‚  â”‚  â””â”€ /manual_control (std_msgs/String) - æ‰‹å‹•æ“æ§ âœ¨ æ–°
  â”‚  â”œâ”€ ROS è©±é¡Œè¨‚é–± (/encoder_state, /robot_status)
  â”‚  â”œâ”€ å°èˆªç‹€æ…‹ç®¡ç† (navigationActive, motorPaused)
  â”‚  â”œâ”€ æŒ‰éˆ•äº‹ä»¶è™•ç† (æš«åœ/ç¹¼çºŒ/å–æ¶ˆ)
  â”‚  â”œâ”€ éµç›¤äº‹ä»¶è™•ç† (WASD + Space) âœ¨ æ–°
  â”‚  â””â”€ æ‰‹å‹•æ§åˆ¶ç™¼é€é‚è¼¯
  â”‚
  â”œâ”€ è·¯å¾‘è¨˜æ†¶ (trust_map_solver.py)
  â”‚  â”œâ”€ historical_walls æ•¸æ“šçµæ§‹
  â”‚  â”œâ”€ æƒæåˆ°çš„ç‰†é«”æ°¸ä¹…ä¿å­˜
  â”‚  â””â”€ ç™¼ä½ˆåŒ…å«æ­·å²æ•¸æ“šçš„åœ°åœ–
  â”‚
  â”œâ”€ ç³»çµ±å•Ÿå‹• (start_all.py) âœ¨ å·²æ›´æ–°
  â”‚  â”œâ”€ ROS_DOMAIN_ID=30 è¨­å®š
  â”‚  â”œâ”€ ç›¸å°è·¯å¾‘è‡ªå‹•è§£æ (å·¥ä½œå€å¯ç§»å‹•!)
  â”‚  â”œâ”€ æ‰€æœ‰æœå‹™è‡ªå‹•å•Ÿå‹•
  â”‚  â””â”€ æ­£ç¢ºçš„ç’°å¢ƒè®Šæ•¸å‚³é
  â”‚
  â””â”€ æ¸¬è©¦å·¥å…· (test_navigation.py)
     â”œâ”€ ç›£è½ /nav_goal
     â”œâ”€ ç›£è½ /motor_control
     â”œâ”€ ç™¼ä½ˆ /encoder_state (æ¨¡æ“¬)
     â””â”€ ç™¼ä½ˆ /robot_status (æ¨¡æ“¬)

â³ å¾…å¯¦ç¾ (PI ç«¯ - ä¸åœ¨ WSL):
  â”œâ”€ é¦¬é”é©…å‹• (GPIO æ§åˆ¶)
  â”œâ”€ ç·¨ç¢¼å™¨è®€å– (å…‰å­¸è„ˆè¡)
  â”œâ”€ å¯¼èˆªç®—æ³•å¯¦ç¾
  â””â”€ åƒè€ƒç¯„æœ¬: pi_motor_controller_template.py

================================================================================

ã€æª”æ¡ˆæ˜ å°„ã€‘

index.html
  â””â”€ åŒ…å«: nav-bar, encoder-panel, æš«åœ/å–æ¶ˆæŒ‰éˆ•

style.css
  â”œâ”€ #nav-bar - åº•éƒ¨æ§åˆ¶æ¬„
  â”œâ”€ #encoder-panel - å³ä¸Šç·¨ç¢¼å™¨é¡¯ç¤º
  â”œâ”€ .pause-btn - æš«åœæŒ‰éˆ• (å‹•æ…‹é¡: .resumed)
  â””â”€ å‹•ç•«: slideUp (0.3s)

map_viewer.js
  â”œâ”€ navigationActive - å°èˆªé€²è¡Œä¸­æ¨™èªŒ
  â”œâ”€ motorPaused - é¦¬é”æš«åœæ¨™èªŒ
  â”œâ”€ encoderData - ç·¨ç¢¼å™¨æ•¸æ“š
  â”œâ”€ navGoalPublisher - ç™¼ä½ˆå°èˆªç›®æ¨™
  â”œâ”€ motorControlPublisher - ç™¼ä½ˆé¦¬é”å‘½ä»¤
  â”œâ”€ showNavigationBar() - é¡¯ç¤ºåº•éƒ¨æ¬„
  â”œâ”€ updatePauseButtonState() - æ›´æ–°æŒ‰éˆ•å¤–è§€
  â”œâ”€ æ³¡æ³¡é»æ“Š: ç™¼é€ /nav_goal
  â”œâ”€ æš«åœæŒ‰éˆ•: ç™¼é€ PAUSE/RESUME åˆ° /motor_control
  â””â”€ å–æ¶ˆæŒ‰éˆ•: ç™¼é€ CANCEL åˆ° /motor_control

trust_map_solver.py
  â”œâ”€ historical_walls{} - æ°¸ä¹…ç‰†é«”è¨˜éŒ„
  â”œâ”€ current_scan_cells{} - ç•¶å‰æƒæç¯„åœ
  â”œâ”€ update_map() - æ¨™è¨˜å‘½ä¸­é»åˆ°æ­·å²è¨˜éŒ„
  â””â”€ publish_map() - å„ªå…ˆç™¼ä½ˆæ­·å²æ•¸æ“š

start_all.py
  â”œâ”€ ROS_DOMAIN_ID=30 è¨­å®š
  â”œâ”€ rosbridge_websocket å•Ÿå‹•
  â”œâ”€ throttle ç¨ç«‹å•Ÿå‹•
  â”œâ”€ pc_monitor_launch (SLAM)
  â”œâ”€ trust_map_solver
  â””â”€ HTTP server (port 8000)

================================================================================

ã€æ•…éšœæ’é™¤ã€‘

Q: å°èˆªæ¬„ä¸é¡¯ç¤ºï¼Ÿ
A: 1. æª¢æŸ¥ console æ˜¯å¦æœ‰ JS éŒ¯èª¤ (F12)
   2. ç¢ºèª index.html æœ‰ id="nav-bar" å…ƒç´ 
   3. ç¢ºèª map_viewer.js å·²åŠ è¼‰

Q: ç·¨ç¢¼å™¨æ•¸æ“šä¸æ›´æ–°ï¼Ÿ
A: 1. PI æ˜¯å¦ç™¼ä½ˆäº† /encoder_state?
   2. ROS_DOMAIN_ID æ˜¯å¦éƒ½è¨­ç‚º 30?
   3. çµ‚ç«¯ç¢ºèª: ros2 topic echo /encoder_state

Q: è·¯å¾‘ä¸ä¿å­˜ï¼Ÿ
A: 1. æª¢æŸ¥ trust_map_solver.py æ˜¯å¦æœ‰ historical_walls
   2. é‡å•Ÿ start_all.py
   3. æŸ¥çœ‹æ—¥èªŒä¸­çš„ "walls: X" æ•¸å­—æ˜¯å¦å¢åŠ 

Q: æ‰‹å‹•æ§åˆ¶ (WASD) ä¸å·¥ä½œï¼Ÿ
A: 1. ç¢ºèªé¼ æ¨™ç„¦é»åœ¨ç¶²é å…§ (æŒ‰ F12 çœ‹ console)
   2. æª¢æŸ¥: ros2 topic echo /manual_control
   3. ç¢ºèª PI ç«¯è¨‚é–±äº† /manual_control

Q: ç›¸å°è·¯å¾‘ä¸å·¥ä½œï¼Ÿ
A: 1. ç¢ºèªåœ¨ ros2_PC ç›®éŒ„åŸ·è¡Œ start_all.py
   2. æª¢æŸ¥ install/setup.bash æ˜¯å¦å­˜åœ¨
   3. robot_monitor/web ç›®éŒ„æ˜¯å¦å®Œæ•´

Q: é¦¬é”æ§åˆ¶æ²’åæ‡‰ï¼Ÿ
A: 1. PI ç«¯æ˜¯å¦è¨‚é–±äº† /motor_control?
   2. æª¢æŸ¥æ—¥èªŒ: ros2 topic echo /motor_control
   3. ROS_DOMAIN_ID ä¸€è‡´æ€§æª¢æŸ¥

================================================================================

ã€é–‹ç™¼è€…æ–‡æª”ã€‘

è©³è¦‹:
  â€¢ CONTROL_METHODS.md ........... è©³ç´°æ§åˆ¶æ–¹æ³•èªªæ˜ âœ¨ æ–°
  â€¢ NAVIGATION_GUIDE.py ......... å®Œæ•´ç³»çµ±æ–‡æª”
  â€¢ ARCHITECTURE.txt ........... ç³»çµ±æ¶æ§‹åœ–

åƒè€ƒç¯„æœ¬ (PI ç«¯):
  â€¢ pi_motor_controller_template.py ... é¦¬é”æ§åˆ¶å®Œæ•´ç¯„æœ¬
  â€¢ test_navigation.py ................ è¨‚é–±ç¤ºç¯„ç¨‹å¼

================================================================================

ã€é—œéµ ROS 2 è©±é¡Œã€‘

ğŸ“¤ ç™¼ä½ˆ (Publish) - å¾ç¶²é ç™¼å‡º

/nav_goal (geometry_msgs/PoseStamped)
  ä¾†æº: ç¶²é  (å³éµé»æ“Š)
  ç›®æ¨™: PI å°èˆªæ§åˆ¶å™¨
  æ ¼å¼: {position: {x, y, z}, orientation: {x, y, z, w}}
  ç›®çš„: è‡ªå‹•å°èˆªåˆ°æŒ‡å®šåº§æ¨™

/motor_control (std_msgs/String)
  ä¾†æº: ç¶²é  (æš«åœ/ç¹¼çºŒ/å–æ¶ˆæŒ‰éˆ•)
  ç›®æ¨™: PI é¦¬é”æ§åˆ¶å™¨
  æ ¼å¼: "PAUSE" | "RESUME" | "CANCEL"
  ç›®çš„: æ§åˆ¶è‡ªå‹•å°èˆªç‹€æ…‹

/manual_control (std_msgs/String) âœ¨ æ–°
  ä¾†æº: ç¶²é  (éµç›¤ WASD + Space)
  ç›®æ¨™: PI é¦¬é”æ§åˆ¶å™¨
  æ ¼å¼: "FORWARD|0.3" | "LEFT|0.3" | "STOP"
  ç›®çš„: ç›´æ¥æ§åˆ¶é¦¬é”ï¼Œç„¡å°èˆªé‚è¼¯

ğŸ“¥ è¨‚é–± (Subscribe) - å¾ PI æ¥æ”¶

/encoder_state (geometry_msgs/Twist)
  ä¾†æº: PI ç·¨ç¢¼å™¨è®€å–å™¨
  æ¶ˆè²»: ç¶²é  (é¡¯ç¤ºä½ç½®) + PI å°èˆª (åé¥‹)
  æ ¼å¼: {linear: {x, y, z}, angular: {z}}
  ç”¨é€”: æ©Ÿå™¨äººä½ç½®åé¥‹

/robot_status (std_msgs/String)
  ä¾†æº: PI ç‹€æ…‹ç›£æ§
  æ¶ˆè²»: ç¶²é  (å°èˆªæ¬„)
  æ ¼å¼: "NAVIGATING|x|y|distance" æˆ– "IDLE|0|0|0"
  ç”¨é€”: æ©Ÿå™¨äººç‹€æ…‹æ›´æ–°

================================================================================

ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸ¤–

EOF
